
NAME=ppc add instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
af
s loc.add_insns
aezi
aezse 16~var_write
EOF
EXPECT=<<EOF
var_write(name: r1, old: 0x0, new: 0x1)
var_write(name: r2, old: 0x0, new: 0x2)
var_write(name: r3, old: 0x0, new: 0x3)
var_write(name: r4, old: 0x0, new: 0x4)
var_write(name: cr0, old: 0x0, new: 0x4)
var_write(name: r10, old: 0x0, new: 0xffffffffffffffff)
var_write(name: r0, old: 0x0, new: 0x0)
var_write(name: ca, old: 0x0, new: 0x1)
var_write(name: ca32, old: 0x0, new: 0x1)
var_write(name: cr0, old: 0x4, new: 0x2)
var_write(name: r11, old: 0x0, new: 0xffffffffffff0000)
var_write(name: r11, old: 0xffffffffffff0000, new: 0xffffffffffffffff)
var_write(name: r12, old: 0x0, new: 0x0)
var_write(name: ca, old: 0x1, new: 0x1)
var_write(name: ca32, old: 0x1, new: 0x1)
var_write(name: cr0, old: 0x2, new: 0x2)
var_write(name: r13, old: 0x0, new: 0x2)
var_write(name: ca, old: 0x1, new: 0x0)
var_write(name: ca32, old: 0x1, new: 0x0)
var_write(name: cr0, old: 0x2, new: 0x4)
var_write(name: r12, old: 0x0, new: 0x0)
var_write(name: ca, old: 0x0, new: 0x1)
var_write(name: ca32, old: 0x0, new: 0x1)
var_write(name: cr0, old: 0x4, new: 0x2)
var_write(name: r16, old: 0x0, new: 0x0)
var_write(name: ca, old: 0x1, new: 0x0)
var_write(name: ca32, old: 0x1, new: 0x0)
var_write(name: cr0, old: 0x2, new: 0x2)
var_write(name: r12, old: 0x0, new: 0x0)
var_write(name: ca, old: 0x0, new: 0x1)
var_write(name: ca32, old: 0x0, new: 0x1)
var_write(name: cr0, old: 0x2, new: 0x2)
var_write(name: r17, old: 0x0, new: 0x1)
var_write(name: ca, old: 0x1, new: 0x0)
var_write(name: ca32, old: 0x1, new: 0x0)
var_write(name: cr0, old: 0x2, new: 0x2)
var_write(name: r17, old: 0x1, new: 0xffffffffffffffff)
var_write(name: ca, old: 0x0, new: 0x0)
var_write(name: ca32, old: 0x0, new: 0x0)
var_write(name: cr0, old: 0x2, new: 0x8)
var_write(name: r17, old: 0xffffffffffffffff, new: 0x1)
EOF
RUN

NAME=ppc sub instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
af
s loc.sub_insns
aezi
aezse 18~var_write
EOF
EXPECT=<<EOF
var_write(name: r0, old: 0x0, new: 0x0)
var_write(name: r1, old: 0x0, new: 0x1)
var_write(name: r2, old: 0x0, new: 0x2)
var_write(name: r3, old: 0x0, new: 0x3)
var_write(name: r1, old: 0x1, new: 0x1)
var_write(name: cr0, old: 0x0, new: 0x4)
var_write(name: r0, old: 0x0, new: 0x0)
var_write(name: cr0, old: 0x4, new: 0x2)
var_write(name: r11, old: 0x0, new: 0xffffffffffffffff)
var_write(name: cr0, old: 0x2, new: 0x8)
var_write(name: r11, old: 0xffffffffffffffff, new: 0xffffffffffffffff)
var_write(name: ca, old: 0x0, new: 0x0)
var_write(name: ca32, old: 0x0, new: 0x0)
var_write(name: cr0, old: 0x8, new: 0x8)
var_write(name: r0, old: 0x0, new: 0x0)
var_write(name: ca, old: 0x0, new: 0x1)
var_write(name: ca32, old: 0x0, new: 0x1)
var_write(name: cr0, old: 0x8, new: 0x2)
var_write(name: r11, old: 0xffffffffffffffff, new: 0xffffffffffffffff)
var_write(name: ca, old: 0x1, new: 0x0)
var_write(name: ca32, old: 0x1, new: 0x0)
var_write(name: r0, old: 0x0, new: 0x0)
var_write(name: ca, old: 0x0, new: 0x1)
var_write(name: ca32, old: 0x0, new: 0x1)
var_write(name: r11, old: 0xffffffffffffffff, new: 0xffffffffffffffff)
var_write(name: ca, old: 0x1, new: 0x0)
var_write(name: ca32, old: 0x1, new: 0x0)
var_write(name: cr0, old: 0x2, new: 0x8)
var_write(name: r12, old: 0x0, new: 0xfffffffffffffffe)
var_write(name: ca, old: 0x0, new: 0x0)
var_write(name: ca32, old: 0x0, new: 0x0)
var_write(name: cr0, old: 0x8, new: 0x8)
var_write(name: r13, old: 0x0, new: 0xfffffffffffffffd)
var_write(name: ca, old: 0x0, new: 0x1)
var_write(name: ca32, old: 0x0, new: 0x1)
var_write(name: cr0, old: 0x8, new: 0x8)
var_write(name: r12, old: 0xfffffffffffffffe, new: 0xfffffffffffffffe)
var_write(name: ca, old: 0x1, new: 0x0)
var_write(name: ca32, old: 0x1, new: 0x0)
var_write(name: cr0, old: 0x8, new: 0x8)
var_write(name: r11, old: 0xffffffffffffffff, new: 0xffffffffffffffff)
var_write(name: ca, old: 0x0, new: 0x0)
var_write(name: ca32, old: 0x0, new: 0x0)
var_write(name: cr0, old: 0x8, new: 0x8)
var_write(name: r0, old: 0x0, new: 0x0)
var_write(name: ca, old: 0x0, new: 0x1)
var_write(name: ca32, old: 0x0, new: 0x1)
var_write(name: cr0, old: 0x8, new: 0x2)
var_write(name: r10, old: 0x0, new: 0x0)
var_write(name: ca, old: 0x1, new: 0x1)
var_write(name: ca32, old: 0x1, new: 0x1)
var_write(name: cr0, old: 0x2, new: 0x2)
EOF
RUN

NAME=ppc store instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
e io.cache=true
wc-*
s loc.store_insns
aezi
aezse 15~mem_write
aezse 4~var_write
EOF
EXPECT=<<EOF
mem_write(addr: 0x8001010, old: 0x0, new: 0xff)
mem_write(addr: 0x8001020, old: 0x0, new: 0xffff)
mem_write(addr: 0x8001030, old: 0x0, new: 0xffffffff)
mem_write(addr: 0x8001040, old: 0x0, new: 0xffffffffffffffff)
mem_write(addr: 0x8001010, old: 0xff, new: 0xff)
mem_write(addr: 0x8001020, old: 0xffff, new: 0xffff)
mem_write(addr: 0x8001030, old: 0xffffffff, new: 0xffffffff)
mem_write(addr: 0x8001040, old: 0xffffffffffffffff, new: 0xffffffffffffffff)
var_write(name: r21, old: 0x8001010, new: 0x8001010)
var_write(name: r21, old: 0x8001010, new: 0x8001020)
var_write(name: r21, old: 0x8001020, new: 0x8001030)
var_write(name: r21, old: 0x8001030, new: 0x8001040)
EOF
RUN

NAME=ppc load instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
e io.cache=true
wc-*
s loc.test_loads
aezi
aezs 22
aezse 16~var_write
aezs 2
aezse 2~var_write
# aezse 1~var_write -> ldbrx instruction
EOF
EXPECT=<<EOF
var_write(name: r11, old: 0xffffffffffffffff, new: 0x0)
var_write(name: r12, old: 0x10, new: 0x10)
var_write(name: r13, old: 0x20, new: 0x20)
var_write(name: r14, old: 0x30, new: 0x30)
var_write(name: r21, old: 0x8001040, new: 0x8000000)
var_write(name: r21, old: 0x8000000, new: 0x8001010)
var_write(name: r11, old: 0x0, new: 0xff)
var_write(name: r11, old: 0xff, new: 0xffff)
var_write(name: r11, old: 0xffff, new: 0xffffffff)
var_write(name: r11, old: 0xffffffff, new: 0xffffffffffffffff)
var_write(name: r11, old: 0xffffffffffffffff, new: 0xff)
var_write(name: r11, old: 0xff, new: 0xffff)
var_write(name: r11, old: 0xffff, new: 0xffffffff)
var_write(name: r11, old: 0xffffffff, new: 0xffffffffffffffff)
var_write(name: r11, old: 0xffffffffffffffff, new: 0xffffffffffffffff)
var_write(name: r11, old: 0xffffffffffffffff, new: 0xffffffffffffffff)
var_write(name: r11, old: 0xffffffffffffffff, new: 0x2301)
var_write(name: r11, old: 0x2301, new: 0x67452301)
EOF
RUN

NAME=ppc logical instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
s loc.logical_insns
aezi
aezse 17~var_write
# EXTS tests
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 2~var_write
aezs 5
aezse 1~var_write
EOF
EXPECT=<<EOF
var_write(name: r0, old: 0x0, new: 0x0)
var_write(name: r1, old: 0x0, new: 0x1)
var_write(name: r11, old: 0x0, new: 0xffffffffffffffff)
var_write(name: r21, old: 0x0, new: 0x1)
var_write(name: r12, old: 0x0, new: 0xfffffffffffffffe)
var_write(name: r1, old: 0x1, new: 0x1)
var_write(name: cr0, old: 0x0, new: 0x4)
var_write(name: r30, old: 0x0, new: 0xffff0000)
var_write(name: cr0, old: 0x4, new: 0x4)
var_write(name: r1, old: 0x1, new: 0x1)
var_write(name: r12, old: 0xfffffffffffffffe, new: 0xfffffffffffffffe)
var_write(name: r5, old: 0x0, new: 0x5555)
var_write(name: r5, old: 0x5555, new: 0x55550000)
var_write(name: r5, old: 0x55550000, new: 0xffffffffaaaaffff)
var_write(name: r5, old: 0xffffffffaaaaffff, new: 0xffffffffaaaa3333)
var_write(name: r5, old: 0xffffffffaaaa3333, new: 0xffffffff66663333)
var_write(name: r12, old: 0xfffffffffffffffe, new: 0xfffffffffffffffe)
var_write(name: r12, old: 0xfffffffffffffffe, new: 0xfffffffffffffffe)
var_write(name: r20, old: 0x0, new: 0xffffffff66663333)
var_write(name: r10, old: 0x0, new: 0xffffffffffffff80)
var_write(name: r10, old: 0xffffffffffffff80, new: 0x7f)
var_write(name: r10, old: 0x7f, new: 0xffffffffffff8000)
var_write(name: r10, old: 0xffffffffffff8000, new: 0x7fff)
var_write(name: r10, old: 0x7fff, new: 0xffffffff80000000)
var_write(name: r10, old: 0xffffffff80000000, new: 0x7fffffff)
var_write(name: r13, old: 0x0, new: 0x40)
var_write(name: r13, old: 0x40, new: 0x0)
var_write(name: r13, old: 0x0, new: 0x20)
var_write(name: r13, old: 0x20, new: 0x0)
var_write(name: r13, old: 0x0, new: 0x20)
EOF
RUN

NAME=ppc compare instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
s loc.compare_insns
aezi
aezs 1 # li r0, 0
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezs 5
aezse 1~var_write
aezse 4~var_write
# aezs 4
# aezse 1~var_write
# aezs 1
# aezse 1~var_write
EOF
EXPECT=<<EOF
var_write(name: cr0, old: 0x0, new: 0x8)
var_write(name: cr0, old: 0x8, new: 0x8)
var_write(name: cr1, old: 0x0, new: 0x4)
var_write(name: cr1, old: 0x4, new: 0x4)
var_write(name: cr2, old: 0x0, new: 0x8)
var_write(name: cr2, old: 0x8, new: 0x8)
var_write(name: cr3, old: 0x0, new: 0x2)
var_write(name: cr3, old: 0x2, new: 0x2)
var_write(name: cr4, old: 0x0, new: 0x4)
var_write(name: cr5, old: 0x0, new: 0x8)
var_write(name: cr6, old: 0x0, new: 0x8)
var_write(name: cr7, old: 0x0, new: 0x8)
EOF
RUN

NAME=ppc branch instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
s loc.branch_insns
aezi
aezse 46
EOF
EXPECT=<<EOF
pc_write(old: 0x80001c8, new: 0x80001cc)
var_write(name: r1, old: 0x0, new: 0x1)
pc_write(old: 0x80001cc, new: 0x80001d0)
var_write(name: r20, old: 0x0, new: 0x0)
pc_write(old: 0x80001d0, new: 0x80001d4)
var_write(name: lr, old: 0x0, new: 0x80001d4)
pc_write(old: 0x80001d4, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x80001d4)
pc_write(old: 0x80001d4, new: 0x80001d8)
var_write(name: r20, old: 0x0, new: 0x8000000)
pc_write(old: 0x80001d8, new: 0x80001dc)
var_write(name: r20, old: 0x8000000, new: 0x80001c4)
pc_write(old: 0x80001dc, new: 0x80001e0)
var_write(name: ctr, old: 0x0, new: 0x80001c4)
pc_write(old: 0x80001e0, new: 0x80001e4)
var_write(name: lr, old: 0x80001d4, new: 0x80001e4)
pc_write(old: 0x80001e4, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x80001e4)
pc_write(old: 0x80001e4, new: 0x80001e8)
var_write(name: ctr, old: 0x80001c4, new: 0x80001c3)
var_write(name: lr, old: 0x80001e4, new: 0x80001e8)
pc_write(old: 0x80001e8, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x80001e8)
pc_write(old: 0x80001e8, new: 0x80001ec)
var_write(name: ctr, old: 0x80001c3, new: 0x1)
pc_write(old: 0x80001ec, new: 0x80001f0)
var_write(name: ctr, old: 0x1, new: 0x0)
var_write(name: lr, old: 0x80001e8, new: 0x80001f0)
pc_write(old: 0x80001f0, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x80001f0)
pc_write(old: 0x80001f0, new: 0x80001f4)
var_write(name: lr, old: 0x80001f0, new: 0x80001f4)
pc_write(old: 0x80001f4, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x80001f4)
pc_write(old: 0x80001f4, new: 0x80001f8)
var_write(name: cr0, old: 0x0, new: 0x2)
pc_write(old: 0x80001f8, new: 0x80001fc)
var_write(name: lr, old: 0x80001f4, new: 0x80001fc)
pc_write(old: 0x80001fc, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x80001fc)
pc_write(old: 0x80001fc, new: 0x8000200)
var_write(name: ctr, old: 0x0, new: 0x80001c4)
pc_write(old: 0x8000200, new: 0x8000204)
var_write(name: r10, old: 0x0, new: 0xfff0000)
pc_write(old: 0x8000204, new: 0x8000208)
var_write(name: r10, old: 0xfff0000, new: 0xfff0ff0)
pc_write(old: 0x8000208, new: 0x800020c)
var_write(name: cr, old: 0x0, new: 0xfff0ff0)
var_write(name: cr0, old: 0x2, new: 0x0)
var_write(name: cr1, old: 0x0, new: 0xf)
var_write(name: cr2, old: 0x0, new: 0xf)
var_write(name: cr3, old: 0x0, new: 0x0)
var_write(name: cr4, old: 0x0, new: 0xf)
var_write(name: cr5, old: 0x0, new: 0xf)
var_write(name: cr6, old: 0x0, new: 0xf)
var_write(name: cr7, old: 0x0, new: 0x0)
pc_write(old: 0x800020c, new: 0x8000210)
var_write(name: ctr, old: 0x80001c4, new: 0x80001c3)
var_write(name: lr, old: 0x80001fc, new: 0x8000210)
pc_write(old: 0x8000210, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x8000210)
pc_write(old: 0x8000210, new: 0x8000214)
var_write(name: r10, old: 0xfff0ff0, new: 0x1000)
pc_write(old: 0x8000214, new: 0x8000218)
var_write(name: cr, old: 0xfff0ff0, new: 0xfff1ff0)
var_write(name: cr3, old: 0x0, new: 0x1)
pc_write(old: 0x8000218, new: 0x800021c)
var_write(name: ctr, old: 0x80001c3, new: 0x80001c2)
var_write(name: lr, old: 0x8000210, new: 0x800021c)
pc_write(old: 0x800021c, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x800021c)
pc_write(old: 0x800021c, new: 0x8000220)
var_write(name: ctr, old: 0x80001c2, new: 0x1)
pc_write(old: 0x8000220, new: 0x8000224)
var_write(name: cr, old: 0xfff1ff0, new: 0xf0f1ff0)
var_write(name: cr5, old: 0xf, new: 0x0)
pc_write(old: 0x8000224, new: 0x8000228)
var_write(name: ctr, old: 0x1, new: 0x0)
var_write(name: lr, old: 0x800021c, new: 0x8000228)
pc_write(old: 0x8000228, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x8000228)
pc_write(old: 0x8000228, new: 0x800022c)
var_write(name: ctr, old: 0x0, new: 0x1)
pc_write(old: 0x800022c, new: 0x8000230)
var_write(name: r10, old: 0x1000, new: 0x0)
pc_write(old: 0x8000230, new: 0x8000234)
var_write(name: r10, old: 0x0, new: 0x10000000)
pc_write(old: 0x8000234, new: 0x8000238)
var_write(name: cr, old: 0xf0f1ff0, new: 0x1f0f1ff0)
var_write(name: cr7, old: 0x0, new: 0x1)
pc_write(old: 0x8000238, new: 0x800023c)
var_write(name: ctr, old: 0x1, new: 0x0)
var_write(name: lr, old: 0x8000228, new: 0x800023c)
pc_write(old: 0x800023c, new: 0x80001c4)
pc_write(old: 0x80001c4, new: 0x80001c8)
pc_write(old: 0x80001c8, new: 0x800023c)
pc_write(old: 0x800023c, new: 0x8000240)
var_write(name: ctr, old: 0x0, new: 0x0)
pc_write(old: 0x8000240, new: 0x8000244)
var_write(name: ctr, old: 0x0, new: 0xffffffffffffffff)
var_write(name: lr, old: 0x800023c, new: 0x8000244)
pc_write(old: 0x8000244, new: 0x8000244)
pc_write(old: 0x8000244, new: 0x8000248)
var_write(name: ctr, old: 0xffffffffffffffff, new: 0x1)
pc_write(old: 0x8000248, new: 0x800024c)
var_write(name: r3, old: 0x0, new: 0x3)
pc_write(old: 0x800024c, new: 0x8000250)
var_write(name: cr, old: 0x1f0f1ff0, new: 0x1f0f1ff3)
var_write(name: cr0, old: 0x0, new: 0x3)
pc_write(old: 0x8000250, new: 0x8000254)
var_write(name: ctr, old: 0x1, new: 0x0)
var_write(name: lr, old: 0x8000244, new: 0x8000254)
pc_write(old: 0x8000254, new: 0x8000254)
pc_write(old: 0x8000254, new: 0x8000258)
pc_write(old: 0x8000258, new: 0xc0ffe0)
EOF
RUN

NAME=ppc shift instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
s loc.shift_insns
aezi
aezs 4
aezse 6~var_write
aezs 3
aezse 4~var_write
EOF
EXPECT=<<EOF
var_write(name: r10, old: 0x0, new: 0xedcba98765432100)
var_write(name: r10, old: 0xedcba98765432100, new: 0xfedcba987654321)
var_write(name: r10, old: 0xfedcba987654321, new: 0x65432100)
var_write(name: r10, old: 0x65432100, new: 0x7654321)
var_write(name: r10, old: 0x7654321, new: 0xffedcba987654321)
var_write(name: ca, old: 0x0, new: 0x0)
var_write(name: ca32, old: 0x0, new: 0x0)
var_write(name: r10, old: 0xffedcba987654321, new: 0xffedcba987654321)
var_write(name: ca, old: 0x0, new: 0x0)
var_write(name: ca32, old: 0x0, new: 0x0)
var_write(name: r10, old: 0xffedcba987654321, new: 0xfffffffff89abcde)
var_write(name: ca, old: 0x0, new: 0x1)
var_write(name: ca32, old: 0x0, new: 0x1)
var_write(name: r10, old: 0xfffffffff89abcde, new: 0xfffffffff89abcde)
var_write(name: ca, old: 0x1, new: 0x1)
var_write(name: ca32, old: 0x1, new: 0x1)
var_write(name: r10, old: 0xfffffffff89abcde, new: 0x32100000)
var_write(name: r10, old: 0x32100000, new: 0x7654)
EOF
RUN

NAME=ppc rotate instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
s loc.rotate_insns
aezi
aezs 4
aezse 16~var_write
EOF
EXPECT=<<EOF
var_write(name: r10, old: 0x0, new: 0x4320000)
var_write(name: r10, old: 0x4320000, new: 0x5432107654321076)
var_write(name: r10, old: 0x5432107654321076, new: 0x0)
var_write(name: r10, old: 0x0, new: 0x5432107650001076)
var_write(name: r10, old: 0x5432107650001076, new: 0x0)
var_write(name: r10, old: 0x0, new: 0x5432107654321076)
var_write(name: r10, old: 0x5432107654321076, new: 0xa9876543210f)
var_write(name: r10, old: 0xa9876543210f, new: 0x0)
var_write(name: r10, old: 0x0, new: 0xcba98765432100)
var_write(name: r10, old: 0xcba98765432100, new: 0xedcba9876543210f)
var_write(name: r10, old: 0xedcba9876543210f, new: 0x65432107)
var_write(name: r10, old: 0x65432107, new: 0xcba9876543210)
var_write(name: r10, old: 0xcba9876543210, new: 0x43210)
var_write(name: r10, old: 0x43210, new: 0x7edcba9876543210)
var_write(name: cr0, old: 0x0, new: 0x4)
var_write(name: r10, old: 0x7edcba9876543210, new: 0xfedcba9876543210)
var_write(name: cr0, old: 0x4, new: 0x8)
var_write(name: r10, old: 0xfedcba9876543210, new: 0x0)
var_write(name: cr0, old: 0x8, new: 0x2)
EOF
RUN

NAME=ppc special instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
s loc.special_insns
aezi
aezse 2
EOF
EXPECT=<<EOF
pc_write(old: 0x8000258, new: 0x800025c)
pc_write(old: 0x800025c, new: 0x8000260)
EOF
RUN

NAME=ppc move to from spr instructions
FILE=bins/elf/ppc/ppc64_fp
ARGS=-appc
CMDS=<<EOF
s loc.read_set_spr
aezi
aezs 5
aezse 4~var_write
EOF
EXPECT=<<EOF
var_write(name: ctr, old: 0x0, new: 0xffffffffffffffff)
var_write(name: r28, old: 0xffffffffffffffff, new: 0xffffffffffffffff)
var_write(name: lr, old: 0x8000264, new: 0xffffffffffffffff)
var_write(name: r28, old: 0xffffffffffffffff, new: 0xffffffffffffffff)
EOF
RUN

NAME=ppc CR logical instructions
FILE=bins/elf/ppc/ppc64_fp
BROKEN=1
ARGS=-appc
CMDS=<<EOF
s loc.cr_logical_insns
aezi
aezs 3
aezse 5~var_write
aezs
aezse 2~var_write
EOF
EXPECT=<<EOF
var_write(name: cr2, old: 0x1, new: 0x0)
var_write(name: cr2, old: 0x0, new: 0x1)
var_write(name: cr2, old: 0x1, new: 0x1)
var_write(name: cr2, old: 0x1, new: 0x0)
var_write(name: cr5, old: 0x1, new: 0x0)
var_write(name: cr7, old: 0x0, new: 0x1)
var_write(name: cr7, old: 0x1, new: 0x1)
EOF
RUN